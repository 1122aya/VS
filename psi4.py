import psi4

# Set memory and number of threads
psi4.set_memory('2 GB')
psi4.set_num_threads(2)

# Define m1 molecule
m1 = psi4.geometry("""
C -3.9382173853904345 1.255735984524168 0.5392655318888152
C -2.7164342897997282 1.3568173803412928 -0.08421459464619767
N -1.7922888893103162 0.3797469238176354 -0.0659392119332603
C -2.147652099870573 -0.7373841986985438 0.5696209250564297
N -3.2770626000814786 -0.9341479928069559 1.2576869899104381
C -4.166422983211335 0.07511217689118084 1.2075890723598834
N -1.2010693507441892 -1.7321145310399626 0.775139587166355
S -0.24237482013349856 -2.157711585331249 -0.5107322091318715
O -0.9961877059077207 -2.079020147858285 -1.7443475781646165
O 0.39695850056276 -3.403571450073437 -0.13199462585654775
C 1.0358679034045775 -0.9253950951891382 -0.5192304345837664
C 1.0981173165608902 0.013865014823582399 -1.5493852140239772
C 2.125610636056633 0.9610822902212042 -1.5543484681082995
C 3.1194925004507823 0.9446983683937855 -0.5699893187596978
C 3.0154393373304953 0.026166016593000906 0.4800438817370422
C 1.9931076491607478 -0.9262731987747577 0.49767836567099766
N 4.074431905850039 1.9669595078687672 -0.51787201339802
H -4.666065647159587 2.0546720867698136 0.5139609541826999
H -2.432846124201903 2.254336720971454 -0.6265413443578575
H -5.095849721160188 -0.09657830808315938 1.7432115020697945
H -1.5563563782920022 -2.5216604730672985 1.3003880288973737
H 0.34426941654588034 0.03010665615090785 -2.3328364202544734
H 2.144510472495916 1.7134195723880166 -2.338487603725501
H 3.7362729707196536 0.04185426940570115 1.2934188817627315
H 1.9436337276945201 -1.6522958510205636 1.3053197755395973
H 4.911680379767427 1.7191367980121814 0.0001753344288128754
H 4.289435278662942 2.372443064770748 -1.4234778157892545
""")


# Run optimization at B3LYP/6-31G*
energy, wfn = psi4.optimize("B3LYP/6-31G*", molecule=m1, return_wfn=True)

print("Optimized Energy:", energy)
print("Final Geometry:\n", m1.save_string_xyz())